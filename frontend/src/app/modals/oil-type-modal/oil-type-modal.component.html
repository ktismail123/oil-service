<div class="modal-overlay" (click)="closeModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    
    <!-- Modal Header -->
    <div class="modal-header">
      <h2>{{ isEditMode() ? 'Edit Oil Type' : 'Add New Oil Type' }}</h2>
      <button class="close-btn" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
      <form [formGroup]="oilTypeForm" (ngSubmit)="onSubmit()">
        
        <!-- Name and Grade Row -->
        <div class="form-row">
          <div class="form-group">
            <label for="name">Oil Name *</label>
            <input
              id="name"
              type="text"
              formControlName="name"
              class="form-input"
              placeholder="Enter oil name">
            <div *ngIf="isNameInvalid()" class="error-msg">
              {{ getNameErrorMessage() }}
            </div>
          </div>

          <div class="form-group">
            <label for="grade">Grade *</label>
            <input
              id="grade"
              type="text"
              formControlName="grade"
              class="form-input"
              placeholder="Enter grade (e.g., 5W30, 10W40)">
            <div *ngIf="isGradeInvalid()" class="error-msg">
              {{ getGradeErrorMessage() }}
            </div>
          </div>
        </div>

        <!-- Brand and Service Interval Row -->
        <div class="form-row">
          <div class="form-group">
            <label for="brand">Brand *</label>
            <input
              id="brand"
              type="text"
              formControlName="brand"
              class="form-input"
              placeholder="Enter brand name">
            <div *ngIf="isBrandInvalid()" class="error-msg">
              {{ getBrandErrorMessage() }}
            </div>
          </div>

          <div class="form-group">
            <label for="serviceInterval">Service Interval *</label>
            <select id="serviceInterval" formControlName="service_interval" class="form-select">
              <option value="">Select service interval</option>
              <option value="5000">5,000 km</option>
              <option value="10000">10,000 km</option>
              <option value="15000">15,000 km</option>
            </select>
            <div *ngIf="isServiceIntervalInvalid()" class="error-msg">
              {{ getServiceIntervalErrorMessage() }}
            </div>
          </div>
        </div>

        <!-- Package Availability Section -->
        <div class="form-section">
          <h4>Package Availability</h4>
          
          <div class="form-row">
            <!-- Package 1L Available -->
            <div class="form-group">
              <label for="package1l">1L Package Available</label>
              <select id="package1l" formControlName="package_1l_available" class="form-select">
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>

            <!-- Package 4L Available -->
            <div class="form-group">
              <label for="package4l">4L Package Available</label>
              <select id="package4l" formControlName="package_4l_available" class="form-select">
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>

            <!-- Bulk Available -->
            <div class="form-group">
              <label for="bulk">Bulk Available</label>
              <select id="bulk" formControlName="bulk_available" class="form-select">
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Pricing Section -->
        <div class="form-section">
          <h4>Pricing</h4>
          
          <div class="form-row">
            <!-- Price 1L -->
            <div class="form-group">
              <label for="price1l">Price per 1L *</label>
              <input
                id="price1l"
                type="number"
                step="0.01"
                min="0"
                formControlName="price_1l"
                class="form-input"
                placeholder="Enter price for 1L">
              <div *ngIf="isPrice1lInvalid()" class="error-msg">
                {{ getPrice1lErrorMessage() }}
              </div>
            </div>

            <!-- Price 4L -->
            <div class="form-group">
              <label for="price4l">Price per 4L *</label>
              <input
                id="price4l"
                type="number"
                step="0.01"
                min="0"
                formControlName="price_4l"
                class="form-input"
                placeholder="Enter price for 4L">
              <div *ngIf="isPrice4lInvalid()" class="error-msg">
                {{ getPrice4lErrorMessage() }}
              </div>
            </div>

            <!-- Price per Liter -->
            <div class="form-group">
              <label for="pricePerLiter">Price per Liter *</label>
              <input
                id="pricePerLiter"
                type="number"
                step="0.01"
                min="0"
                formControlName="price_per_liter"
                class="form-input"
                placeholder="Enter price per liter">
              <div *ngIf="isPricePerLiterInvalid()" class="error-msg">
                {{ getPricePerLiterErrorMessage() }}
              </div>
            </div>
          </div>
        </div>

        <!-- Success Message -->
        <div *ngIf="successMessage()" class="success-msg">
          {{ successMessage() }}
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage()" class="error-msg">
          {{ errorMessage() }}
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="isSubmitting()">
            <span *ngIf="isSubmitting()">{{ isEditMode() ? 'Updating...' : 'Creating...' }}</span>
            <span *ngIf="!isSubmitting()">{{ isEditMode() ? 'Update Oil Type' : 'Create Oil Type' }}</span>
          </button>
        </div>

      </form>
    </div>
  </div>
</div>