<!-- Customer Information Form -->
 <!-- Action Buttons (visible on screen, hidden when printing) -->
<div class="text-center mb-6 print:hidden space-y-3">

<!-- Fixed Responsive Button Layout -->
<div class="w-full max-w-md mx-auto">
  <div class="flex flex-col sm:flex-row gap-3 items-stretch">
    
    <!-- Submit Button -->
    <button 
      (click)="onSubmitBooking()"
      [disabled]="customerForm.invalid || (billNumber && !editMode)"
      class="flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition-all duration-200 flex items-center justify-center group transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-4 focus:ring-green-300">
      <svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
      </svg>
      <span class="hidden sm:inline">{{buttonText}}</span>
      <span class="sm:hidden">Save</span>
    </button>

    <!-- Print Receipt Button -->
    <button 
      (click)="printReceipt()" 
      [disabled]="customerForm.invalid || !billNumber"
      class="flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition-all duration-200 flex items-center justify-center group transform hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-4 focus:ring-blue-300">
      <svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd"></path>
      </svg>
      <span class="hidden sm:inline">Print Receipt</span>
      <span class="sm:hidden">Print</span>
    </button>
  </div>
</div>


  
  <!-- Form Validation Message -->
  <div *ngIf="customerForm.invalid" class="text-center">
    <p class="text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg py-2 px-4 max-w-md mx-auto">
      <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
      </svg>
      Please fill in all required fields before proceeding
    </p>
  </div>
</div>
<div class="border-b border-dashed border-gray-300 pb-4 mb-4">
  <h3 class="text-sm font-semibold text-gray-700 mb-3 text-center">
    CUSTOMER DETAILS
  </h3>
  <form [formGroup]="customerForm">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <!-- Plate Number -->
      <div>
        <label class="block text-xs text-gray-500 mb-1">Vehicle Plate Number *</label>
        <app-form-field
          [control]="customerForm.get('plateNumber')!"
          placeholder="Enter plate number"
          fieldId="plateNumber"
          [required]="true"
          class="w-full text-sm">
        </app-form-field>
      </div>

      <!-- Mobile Number -->
      <div>
        <label class="block text-xs text-gray-500 mb-1">Mobile Number *</label>
        <app-form-field
          [type]="'number'"
          [control]="customerForm.get('mobile')!"
          placeholder="Enter mobile number"
          fieldId="customerMobile"
          [required]="true"
          class="w-full text-sm">
        </app-form-field>
      </div>

      <!-- Customer Name -->
      <div>
        <label class="block text-xs text-gray-500 mb-1">Customer Name *</label>
        <app-form-field
          [control]="customerForm.get('name')!"
          placeholder="Enter customer name"
          fieldId="customerName"
          [required]="true"
          class="w-full text-sm">
        </app-form-field>
      </div>

      <!-- Labour Cost -->
      <div>
        <label class="block text-xs text-gray-500 mb-1">Labour Cost *</label>
        <app-form-field
          [type]="'number'"
          [control]="customerForm.get('laborCost')!"
          placeholder="Labour Cost"
          fieldId="laborCost"
          [required]="true"
          class="w-full text-sm">
        </app-form-field>
      </div>

      <!-- Memo - Full Width -->
      <div class="md:col-span-2">
        <label class="block text-xs text-gray-500 mb-1">
          <i class="fas fa-file-alt mr-1"></i>
          Service Memo
        </label>
        <textarea
          [formControlName]="'memo'"
          rows="3"
          maxlength="500"
          placeholder="Service notes, special instructions, or observations..."
          class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 resize-y">
        </textarea>
        <div class="flex justify-between items-center mt-1 text-xs">
          <span class="text-gray-400">Optional - for technician reference</span>
          <span class="text-gray-500 tabular-nums">{{ customerForm.get('memo')?.value?.length || 0 }}/500</span>
        </div>
      </div>
    </div>
  </form>
</div>
<!-- Traditional Receipt Layout -->
<div class="max-w-md mx-auto bg-white shadow-lg p-5" id="receipt-content">
  <!-- Receipt Header -->
  <div class="text-center border-b-2 border-dashed border-gray-400 pb-4 mb-4">
    <h1 class="text-2xl font-bold  mb-1">TECH LUBE</h1>
    <p class="text-sm ">Premium Auto Service Center</p>
    <p class="text-xs  mt-1">Tel: {{environment.contact_number}}</p>
    <p class="text-xs ">Email: {{ environment.email }}</p>
    <p class="text-xs ">TRN No: 104135951200003 </p>
  </div>

  <!-- Receipt Number & Date -->
  <div class="text-center mb-4">
    <p class="text-xs ">RECEIPT #{{ billNumber || '----' }}</p>
    <p class="text-xs ">{{ formattedDate | date: 'MM-dd-yyyy' }}</p>
  </div>

  <!-- Service Details -->
  <div class="border-b border-dashed border-gray-300 pb-4 mb-4">
    <h3 class="text-sm font-semibold  mb-3 text-center">
      SERVICE DETAILS
    </h3>

    <!-- Vehicle Info -->
    <div class="flex justify-between text-xs mb-2">
      <span class="">Vehicle:</span>
      <span class="font-medium"
        >{{ selectedBrandName }} {{ selectedModelName }}</span
      >
    </div>

    <!-- Service Interval -->
    <div class="flex justify-between text-xs mb-3">
      <span class="">Service Interval:</span>
      <span class="font-medium">{{ serviceInterval }} KM</span>
    </div>
  </div>

  <!-- Items List -->
  <div class="border-b border-dashed border-gray-300 pb-4 mb-4">
    <h3 class="text-sm font-semibold  mb-3 text-center">
      ITEMS & SERVICES
    </h3>

    <div class="flex justify-between text-xs">
        <div class="flex-1">
          <p class="font-medium">
            Oil Service
          </p>
        </div>
        <div class="text-right">
          <p class="font-medium">{{ (subtotal) | currency : 'AED ' }}</p>
          <!-- <p class="font-medium">{{ (subtotal - laborCost) | currency : 'AED ' }}</p> -->
        </div>
      </div>

    <!-- Engine Oil -->
    <!-- <div *ngIf="selectedOilType" class="mb-3">
      <div class="flex justify-between text-xs">
        <div class="flex-1">
          <p class="font-medium">
            {{ selectedOilType?.grade }} {{ selectedOilType?.brand }}
          </p>
          <p class="text-gray-500">Engine Oil ({{ oilQuantity }}L)</p>
        </div>
        <div class="text-right">
          <p class="font-medium">{{ oilTotalPrice | currency : 'AED ' }}</p>
        </div>
      </div>
    </div> -->

    <!-- Oil Filter -->
    <!-- <div *ngIf="selectedFilter" class="mb-3">
      <div class="flex justify-between text-xs">
        <div class="flex-1">
          <p class="font-medium">{{ selectedFilter?.brand }} Oil Filter</p>
          <p class="text-gray-500">Code: {{ selectedFilter?.code }}</p>
        </div>
        <div class="text-right">
          <p class="font-medium">AED {{ selectedFilter?.price }}</p>
        </div>
      </div>
    </div> -->

    <!-- Accessories -->
    <!-- <div *ngFor="let accessory of selectedAccessories" class="mb-3">
      <div class="flex justify-between text-xs">
        <div class="flex-1">
          <p class="font-medium">{{ accessory.name }}</p>
          <p class="text-gray-500">
            Qty: {{ accessory.quantity || 1 }} x AED
            {{ (accessory.price || 0) }}
          </p>
        </div>
        <div class="text-right">
          <p class="font-medium">
            AED
            {{
              ((accessory.price || 0) * (accessory.quantity || 1))
            }}
          </p>
        </div>
      </div>
    </div> -->
  </div>

  <!-- Totals -->
  <div class="space-y-2 mb-4">
    <div class="flex justify-between text-sm">
      <span class="text-gray-600">Subtotal:</span>
      <span class="font-medium"
        >AED {{ (subtotal || 0).toFixed(2) }}</span
      >
    </div>

    <div class="flex justify-between text-sm">
      <span class="text-gray-600">VAT (5%):</span>
      <span class="font-medium">AED {{ (vatAmount || 0).toFixed(2) }}</span>
    </div>

    <div class="border-t-2 border-dashed border-gray-400 pt-2">
      <div class="flex justify-between text-lg font-bold">
        <span>TOTAL:</span>
        <span>AED {{ ((totalAmount - vatAmount)  || 0).toFixed(2) }}</span>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div
    class="text-center border-t-2 border-dashed border-gray-400 pt-4 text-xs text-gray-500"
  >
    <p class="mb-1">Thank you for choosing Tech Lube!</p>
    <div class="space-y-1">
      <p>Follow us: {{ "@TechLubeUAE" }}</p>
      <p>Visit: www.techlube.ae</p>
    </div>
  </div>

</div>
